# NeoVim

## Organization

```
nvim/                                   | everything here ends up in .config/nvim
├── default.nix                         | what Nix cares about, makes init.lua from hm-init.init.lua
├── hm-init.init.lua                    | points to ./lua/config/lazy.lua
├── lua/                                | ?
│   ├── config/                         | non-plugin-specific stuff
│   │   ├── lazy.lua                    | setup LazyVim
│   │   ├── autocmds.lua                | general autocmds
│   │   ├── keymaps.lua                 | general keymaps
│   │   └── options.lua                 | general options like tabstop and wrap. Called before lazy.nvim so can be
    │                                   | used for things that need to happen early
│   ├── plugins/                        |
│   │   ├── LazyVim.lua                 | TODO: colorscheme
│   │   ├── colortils.lua               | some utilities for neovim
│   │   ├── image.lua                   | view images; only Markdown and Neorg?
│   │   ├── luasnip-latex-snippets.lua  | a port of Gilles Castel's snippets for the LuaSnip engine.
│   │   ├── luasnip.lua                 | snippet engine for neovim written in lua.
│   │   ├── mini-base16.lua             | neovim lua plugin for Base16 colorscheme creation
│   │   ├── neo-tree.lua                | file tree
│   │   ├── neorg.lua                   | notetaking
│   │   ├── nvim-cmp.lua                | completions
│   │   ├── nvim-dap.lua                | TODO: I have a debug mode? I need to learn about this
│   │   ├── nvim-lsp.lua                | language server protocol; can do syntax checking (and way more)
│   │   ├── nvim-treesitter.lua         | code semantics to do highlighting, folds, indents
│   │   ├── vimtex.lua                  | LaTeX
│   │   ├── which-key.lua               | show keybindings as you enter them
│   │   ├── wrapwidth.lua               | wraps long lines virtually at a specific column TODO: probably needs help
│   │   └── zotcite.lua                 | citations from Zotero
│   └── snippets/                       |
│       └── tex.lua                     |
├── after/                              | ? preferences over the rest; mostly small changes to existing plugins
│   └── ftplugin/                       | specific plugins to load only for specific filetypes
│       ├── lua/                        |
│       │   └── mini-pairs.lua          | TODO: this was testing `' for tex, probably needs to be removed
│       └── tex/                        |
│           └── options.lua             |
├── spell/                              | TODO: principly generated by zg but nix seems to interrupt that
│   ├── en.utf-8.add                    |
│   └── en.utf-8.add.spl                |
├── .gitignore                          |
├── .neoconf.json                       | ?
├── LICENSE                             | LazyVim license
├── README.md                           | this doc
├── lazy-lock.json                      | ?
├── lazyvim.json                        | delete? supposedly from Lazy downloading
└── stylua.toml                         | TODO: apparently LSP info?
```

Home-Manager/Nix considers `programs.neovim` to be canonical. It is used to define the `.config/nvim/init.lua`. Strictly, any part of the `.nix` files can mutz with it, but its (mostly) all in `default.nix` (there is a bit in `.nix/aesthetics/colors`).

Now, I just have `programs.neovim.extraLuaConfig` start the `init.lua` with the contents of `hm-init.init.lua`. This in turn `load(config.lazy)` and `nvim` recognizes that as `./lua/config/lazy.lua`. (We also toss into `init.lua` some color stuff from `aesthetics/colors`).

### `lazy.lua`

This file has two jobs: (1) download LazyVim if it hasn't been already (I think this can be removed bc we have `programs.neovim.plugins = [ pkgs.vimPlugins.lazy-nvim ];`) and (2) load up LazyVim with a little bit of setup. Most of this setup isn't that interesting; of note, it says to import everything under `./lua/plugins`.

### `luasnip.lua`

This references everything `./lua/snippets`.

#### `./lua/snippets`

LuaSnip snippets with names determining applicable filetypes. Either as `ft.lua` or `ft/snips1.lua, etc.`.

### Colors

I noted earlier that *mostly* all of the `programs.neovim` happens in `./default.nix`. The asterisk is on color stuff. I have two things appending to the `init.lua`. Both by means of a `programs.neovim.plugins = [{ plugin = ...; config = [colors] }]`.

First, [Stylix](https://github.com/nix-community/stylix) acts (or should) throughout the `.nix` files. Going to [its module for neovim](https://github.com/nix-community/stylix/blob/b135edbdd403896d1ef507934c045f716deb5609/modules/neovim/neovim.nix#L78) (and a bit of my settings), it appends a [`mini.base16`](https://github.com/nvim-mini/mini.base16) setup.

Second, I have (as of 2026-01-05 using `swamp` colors) some lines in `.nix/aesthetics/colors/swamp/neovim/` getting added in a `mini-nvim` plugin.

## TODO

- Get `lazygit` to work with `config` as git
